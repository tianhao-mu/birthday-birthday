<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>é™ˆæ€ç¾½ç”Ÿæ—¥å¿«ä¹</title>
  <!-- Tailwindwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <script>
    tailwindwind.config = {
      theme: {
        extend: {
          colors: {
            'hdmi-blue': '#0071C5',
            'hdmi-red': '#E60012',
            'hdmi-green': '#00A86B',
            'hdmi-yellow': '#FFD100',
            'pastel-pink': '#FFB6C1',
            'pastel-blue': '#ADD8E6',
            'pastel-purple': '#DDA0DD',
            'pastel-yellow': '#FFFACD',
            'pastel-green': '#98FB98'
          },
          fontFamily: {
            sans: ['Arial', 'sans-serif'],
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'float': 'float 3s ease-in-out infinite',
            'sparkle': 'sparkle 2s ease-in-out infinite',
            'fade-in': 'fadeIn 1s ease-in-out',
            'scale-in': 'scaleIn 0.5s ease-out',
            'slide-in': 'slideIn 0.8s ease-out',
            'bounce': 'bounce 0.5s ease-in-out',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            sparkle: {
              '0%, 100%': { opacity: 1, transform: 'scale(1)' },
              '50%': { opacity: 0.7, transform: 'scale(1.1)' },
            },
            fadeIn: {
              '0%': { opacity: 0 },
              '100%': { opacity: 1 },
            },
            scaleIn: {
              '0%': { transform: 'scale(0.8)', opacity: 0 },
              '100%': { transform: 'scale(1)', opacity: 1 },
            },
            slideIn: {
              '0%': { transform: 'translateY(30px)', opacity: 0 },
              '100%': { transform: 'translateY(0)', opacity: 1 },
            },
            bounce: {
              '0%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-20px)' },
              '100%': { transform: 'translateY(0)' },
            },
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .text-shadow-lg {
        text-shadow: 0 4px 8px rgba(0,0,0,0.2);
      }
      .text-shadow-neon {
        text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 15px currentColor;
      }
      .border-gradient {
        border-image: linear-gradient(to right, theme('colors.hdmi-blue'), theme('colors.hdmi-red'), theme('colors.hdmi-green'), theme('colors.hdmi-yellow')) 1;
      }
      .bg-pattern {
        background-image: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
        background-size: 20px 20px;
      }
      .hdmi-overlay {
        background: linear-gradient(135deg, rgba(0,113,197,0.1) 0%, rgba(230,0,18,0.1) 25%, rgba(0,168,107,0.1) 50%, rgba(255,209,0,0.1) 75%);
      }
      .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        opacity: 0;
        animation: confetti 5s ease-in-out infinite;
        z-index: 60; /* æé«˜z-indexç¡®ä¿æ˜¾ç¤ºåœ¨æœ€ä¸Šå±‚ */
        pointer-events: none; /* ç¡®ä¿ä¸å½±å“å“åº”ç”¨æˆ·äº¤äº’ */
        top: -50px; /* ä»é¡¶éƒ¨ä¸Šæ–¹å¼€å§‹ */
      }
      @keyframes confetti {
        0% {
          transform: translateY(0) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(calc(100vh + 50px)) rotate(720deg);
          opacity: 0;
        }
      }
      .candle-flame {
        animation: flame 1s ease-in-out infinite alternate;
      }
      @keyframes flame {
        0% {
          transform: scale(1) rotate(2deg);
        }
        100% {
          transform: scale(1.1) rotate(-2deg);
        }
      }
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center overflow-hidden">
  <!-- HDMIé£æ ¼è¾¹æ¡† - å“åº”å¼è®¾è®¡ -->
  <div class="fixed inset-0 border-4 sm:border-8 border-hdmi-blue z-50 pointer-events-none"></div>
  <div class="fixed inset-1 sm:inset-2 border-2 sm:border-4 border-hdmi-red z-50 pointer-events-none"></div>
  <div class="fixed inset-3 sm:inset-6 border-1 sm:border-2 border-hdmi-green z-50 pointer-events-none"></div>
  <div class="fixed inset-4 sm:inset-8 border border-hdmi-yellow z-50 pointer-events-none"></div>
  
  <!-- ä¸»å®¹å™¨ - å“åº”å¼è®¾è®¡ -->
  <div class="relative w-full max-w-md sm:max-w-4xl aspect-[9/16] sm:aspect-video bg-white rounded-lg shadow-2xl overflow-hidden flex flex-col items-center justify-start p-4 z-10">
    <!-- èƒŒæ™¯å›¾æ¡ˆ -->
    <div class="absolute inset-0 bg-pattern opacity-20"></div>
    
    <!-- HDMIæ ‡å¿— - å“åº”å¼è®¾è®¡ -->
    <div class="absolute top-2 left-2 flex items-center space-x-1.5 bg-black text-pink-300 px-2 py-0.5 rounded-full text-xs opacity-70">
      <div class="flex space-x-1">
        <div class="w-2 h-2 rounded-full bg-hdmi-blue"></div>
        <div class="w-2 h-2 rounded-full bg-hdmi-red"></div>
        <div class="w-2 h-2 rounded-full bg-hdmi-green"></div>
        <div class="w-2 h-2 rounded-full bg-hdmi-yellow"></div>
      </div>
      <span>HDMI</span>
    </div>
    
    <!-- åˆ†è¾¨ç‡æŒ‡ç¤ºå™¨ - å“åº”å¼è®¾è®¡ -->
    <div class="absolute top-2 right-2 bg-black text-pink-300 px-2 py-0.5 rounded-full text-xs opacity-70">
      1080x1920p 60Hz
    </div>
    
    <!-- é¡¶éƒ¨è£…é¥° -->
    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-hdmi-blue via-hdmi-red via-hdmi-green to-hdmi-yellow"></div>
    
    <!-- æ ‡é¢˜ - å“åº”å¼è®¾è®¡ -->
    <div id="title" class="mt-4 sm:mt-8 text-center w-full opacity-0 animate-slide-in">
      <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-pink-500 text-shadow-lg tracking-widest">
        <span class="text-pink-500">ç¥</span>
        <span class="text-pink-500">é™ˆ</span>
        <span class="text-pink-500">æ€</span>
        <span class="text-pink-500">ç¾½</span>
        <span class="text-pink-500">ç”Ÿ</span>
        <span class="text-pink-500">æ—¥</span>
        <span class="text-pink-500">å¿«</span>
        <span class="text-pink-500">ä¹</span>
        <span class="text-pink-500">ï¼</span>
      </h1>
    </div>
    
    <!-- å°çŒª - å“åº”å¼è®¾è®¡ -->
    <div id="pig-container" class="relative w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 lg:w-64 lg:h-64 my-4 opacity-0 animate-scale-in">
      <img id="pig" src="https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/2c7a6b1c5288494d9f2d76b6d1d1b7eb.jpg~tplv-a9rns2rl98-24:720:720.image?rcl=202510191237436A5C2CC2F0524D04CF1D&rk3s=8e244e95&rrcfp=8a172a1a&x-expires=1761453463&x-signature=z724zow5BA4Nt9Sw050p%2FRNmxCY%3D" 
           alt="å¯çˆ±å°çŒª" 
           class="w-full h-full object-contain filter drop-shadow-xl animate-float">
    </div>
    
    <!-- ç¥ç¦è¯­ - å“åº”å¼è®¾è®¡ -->
    <div id="message" class="text-center px-4 opacity-0 animate-slide-in">
      <p class="text-base sm:text-lg md:text-xl lg:text-2xl font-medium text-pink-500">
        æ„¿ä½ æ¯ä¸€å¤©éƒ½åƒä»Šå¤©ä¸€æ ·å¼€å¿ƒå¿«ä¹ï¼
      </p>
      <p class="text-sm sm:text-base md:text-lg lg:text-xl text-pink-500 mt-2">
        è¯·ç‚¹å‡»å°çŒªæˆ–ä¸‹æ–¹æŒ‰é’®
      </p>
    </div>
    
    <!-- äº’åŠ¨æŒ‰é’® - å“åº”å¼è®¾è®¡ï¼Œå¢å¤§è§¦æ‘¸åŒºåŸŸ -->
    <div id="interaction" class="mt-4 sm:mt-6 flex flex-col items-center opacity-0 animate-fade-in w-full px-4">
      <button id="wish-btn" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 px-10 rounded-full shadow-lg transition-all duration-300 flex items-center justify-center space-x-2 z-20 w-full">
        <i class="fa fa-heart text-lg"></i>
        <span>ç‚¹å‡»æœ‰ç¥ç¦</span>
      </button>
      <button id="confetti-btn" class="mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 px-10 rounded-full shadow-lg transition-all duration-300 flex items-center justify-center space-x-2 z-20 w-full">
        <i class="fa fa-gift text-lg"></i>
        <span>åº†ç¥ä¸€ä¸‹</span>
      </button>
    </div>
    
    <!-- åº•éƒ¨è£…é¥° -->
    <div class="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-hdmi-yellow via-hdmi-green via-hdmi-red to-hdmi-blue"></div>
    
    <!-- æ‰«æçº¿æ•ˆæœ -->
    <div class="fixed inset-0 pointer-events-none z-20" id="scanlines"></div>
  </div>
  
  <script>
    // åˆ›å»ºæ‰«æçº¿æ•ˆæœ
    function createScanlines() {
      const scanlines = document.getElementById('scanlines');
      for (let i = 0; i < 100; i++) {
        const line = document.createElement('div');
        line.className = 'absolute w-full h-0.5 bg-white opacity-10';
        line.style.top = `${i}%`;
        scanlines.appendChild(line);
      }
    }
    
    // åˆ›å»ºå½©è‰²çº¸å±‘æ•ˆæœ - ä¼˜åŒ–ç‰ˆæœ¬
    function createConfetti() {
      const colors = ['#FFB6C1', '#ADD8E6', '#DDA0DD', '#FFFACD', '#98FB98', '#FF99CC', '#99CCFF', '#FFCC99'];
      const container = document.querySelector('body'); // æ”¹ä¸ºbodyï¼Œç¡®ä¿è¦†ç›–æ•´ä¸ªå±å¹•
      
      // æ¸…é™¤ç°æœ‰çº¸å±‘
      const existingConfetti = document.querySelectorAll('.confetti');
      existingConfetti.forEach(confetti => confetti.remove());
      
      // åˆ›å»ºæ›´å¤šå½©è‰²çº¸å±‘
      for (let i = 0; i < 150; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = `${Math.random() * 100}%`;
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.width = `${Math.random() * 12 + 3}px`;
        confetti.style.height = `${Math.random() * 12 + 3}px`;
        confetti.style.animationDelay = `${Math.random() * 3}s`;
        confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
        container.appendChild(confetti);
      }
    }
    
    // åˆ›å»ºè¾¹ç¼˜å°çƒŸèŠ±æ•ˆæœ
    function createEdgeFireworks() {
      const container = document.querySelector('body');
      const positions = [
        { left: '5%', top: '5%' },    // å·¦ä¸Š
        { left: '95%', top: '5%' },   // å³ä¸Š
        { left: '5%', top: '95%' },   // å·¦ä¸‹
        { left: '95%', top: '95%' },  // å³ä¸‹
        { left: '50%', top: '5%' },   // ä¸Šä¸­
        { left: '5%', top: '50%' },   // å·¦ä¸­
        { left: '95%', top: '50%' },  // å³ä¸­
        { left: '50%', top: '95%' }   // ä¸‹ä¸­
      ];
      
      const colors = ['#FFB6C1', '#ADD8E6', '#DDA0DD', '#FFFACD', '#98FB98'];
      
      positions.forEach((pos, index) => {
        setTimeout(() => {
          // åˆ›å»ºçƒŸèŠ±ä¸»ä½“
          const firework = document.createElement('div');
          firework.className = 'absolute rounded-full';
          firework.style.left = pos.left;
          firework.style.top = pos.top;
          firework.style.width = '8px';
          firework.style.height = '8px';
          firework.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          firework.style.transform = 'scale(0)';
          firework.style.opacity = '0';
          firework.style.zIndex = '60';
          container.appendChild(firework);
          
          // çƒŸèŠ±ä¸Šå‡åŠ¨ç”»
          setTimeout(() => {
            firework.style.transition = 'all 0.5s ease-out';
            firework.style.transform = 'scale(1)';
            firework.style.opacity = '1';
            
            // çˆ†ç‚¸æ•ˆæœ
            setTimeout(() => {
              // ç§»é™¤çƒŸèŠ±ä¸»ä½“
              firework.remove();
              
              // åˆ›å»ºçˆ†ç‚¸ç²’å­
              for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'absolute rounded-full';
                particle.style.left = pos.left;
                particle.style.top = pos.top;
                particle.style.width = '4px';
                particle.style.height = '4px';
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.opacity = '1';
                particle.style.zIndex = '60';
                container.appendChild(particle);
                
                // ç²’å­é£æ•£åŠ¨ç”»
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 50 + 30;
                setTimeout(() => {
                  particle.style.transition = 'all 0.8s ease-out';
                  particle.style.transform = `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;
                  particle.style.opacity = '0';
                  
                  // ç§»é™¤ç²’å­
                  setTimeout(() => {
                    particle.remove();
                  }, 800);
                }, 10);
              }
            }, 500);
          }, 10);
        }, index * 300); // æ¯ä¸ªçƒŸèŠ±é—´éš”300ms
      });
    }
    
    // åˆ›å»ºçƒŸèŠ±æ•ˆæœ
    function createFireworks() {
      const container = document.querySelector('.max-w-4xl');
      const colors = ['#FFB6C1', '#ADD8E6', '#DDA0DD', '#FFFACD', '#98FB98', '#FF99CC', '#99CCFF', '#FFCC99'];
      
      // åˆ›å»º5ä¸ªçƒŸèŠ±
      for (let i = 0; i < 5; i++) {
        const firework = document.createElement('div');
        firework.className = 'absolute';
        firework.style.left = `${Math.random() * 80 + 10}%`;
        firework.style.top = `${Math.random() * 60 + 20}%`;
        firework.style.width = '20px';
        firework.style.height = '20px';
        firework.style.borderRadius = '50%';
        firework.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        firework.style.transform = 'scale(0)';
        firework.style.opacity = '0';
        container.appendChild(firework);
        
        // çƒŸèŠ±åŠ¨ç”»
        setTimeout(() => {
          firework.style.transition = 'all 0.5s ease-out';
          firework.style.transform = 'scale(1)';
          firework.style.opacity = '1';
          
          // çˆ†ç‚¸æ•ˆæœ
          setTimeout(() => {
            firework.style.transition = 'all 0.3s ease-out';
            firework.style.transform = 'scale(0)';
            firework.style.opacity = '0';
            
            // åˆ›å»ºçˆ†ç‚¸ç¢ç‰‡
            for (let j = 0; j < 20; j++) {
              const fragment = document.createElement('div');
              fragment.className = 'absolute';
              fragment.style.left = `${Math.random() * 10 - 5}px`;
              fragment.style.top = `${Math.random() * 10 - 5}px`;
              fragment.style.width = `${Math.random() * 6 + 2}px`;
              fragment.style.height = `${Math.random() * 6 + 2}px`;
              fragment.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
              fragment.style.transform = 'translate(0, 0) rotate(0deg)';
              fragment.style.opacity = '1';
              
              // éšæœºç¢ç‰‡æ–¹å‘å’Œæ—‹è½¬
              const angle = Math.random() * Math.PI * 2;
              const distance = Math.random() * 50 + 30;
              const rotation = Math.random() * 360;
              
              firework.appendChild(fragment);
              
              // ç¢ç‰‡åŠ¨ç”»
              setTimeout(() => {
                fragment.style.transition = 'all 0.8s ease-out';
                fragment.style.transform = `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) rotate(${rotation}deg)`;
                fragment.style.opacity = '0';
                
                // ç§»é™¤ç¢ç‰‡
                setTimeout(() => {
                  fragment.remove();
                }, 800);
              }, 10);
            }
            
            // ç§»é™¤çƒŸèŠ±
            setTimeout(() => {
              firework.remove();
            }, 300);
          }, 500);
        }, i * 1000);
      }
    }
    
    // åˆ›å»ºç”Ÿæ—¥å¿«ä¹æ–‡å­—åŠ¨ç”»
    function createBirthdayTextAnimation() {
      const container = document.querySelector('.max-w-4xl');
      const texts = ['ç”Ÿæ—¥å¿«ä¹!', 'Happy Birthday!', 'ğŸ‰ğŸ‚ğŸ', 'ğŸˆğŸŠğŸ†'];
      
      texts.forEach((text, index) => {
        const textElement = document.createElement('div');
        textElement.className = 'absolute text-3xl sm:text-4xl md:text-5xl font-bold text-pink-500 text-shadow-lg opacity-0';
        textElement.style.left = `${Math.random() * 70 + 15}%`;
        textElement.style.top = `${Math.random() * 60 + 20}%`;
        textElement.textContent = text;
        container.appendChild(textElement);
        
        // æ–‡å­—åŠ¨ç”»
        setTimeout(() => {
          textElement.style.transition = 'all 0.5s ease-out';
          textElement.style.opacity = '1';
          textElement.style.transform = 'scale(1.2)';
          
          // æ·¡å‡ºæ•ˆæœ
          setTimeout(() => {
            textElement.style.transition = 'all 1s ease-out';
            textElement.style.opacity = '0';
            textElement.style.transform = 'scale(0.8) translateY(-20px)';
            
            // ç§»é™¤æ–‡å­—
            setTimeout(() => {
              textElement.remove();
            }, 1000);
          }, 2000);
        }, index * 1500);
      });
    }
    
    // åˆå§‹åŒ–åŠ¨ç”»
    function initAnimation() {
      // å»¶è¿Ÿæ˜¾ç¤ºå…ƒç´ ï¼Œåˆ›å»ºåºåˆ—åŠ¨ç”»æ•ˆæœ
      setTimeout(() => {
        document.getElementById('title').style.opacity = '1';
      }, 500);
      
      setTimeout(() => {
        document.getElementById('pig-container').style.opacity = '1';
      }, 1000);
      
      setTimeout(() => {
        document.getElementById('message').style.opacity = '1';
      }, 1500);
      
      setTimeout(() => {
        document.getElementById('interaction').style.opacity = '1';
      }, 2000);
    }
    
    // å…¨å±€éŸ³é¢‘ä¸Šä¸‹æ–‡å˜é‡
    let audioContext;
    
    // æµ‹è¯•éŸ³é¢‘åŠŸèƒ½ï¼ˆç”¨äºé¦–æ¬¡ç”¨æˆ·äº¤äº’ï¼‰
    function testAudioOnFirstInteraction() {
      try {
        // åˆ›å»ºä¸´æ—¶éŸ³é¢‘ä¸Šä¸‹æ–‡æµ‹è¯•
        const tempContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = tempContext.createOscillator();
        const gainNode = tempContext.createGain();
        
        oscillator.type = 'sine';
        oscillator.frequency.value = 440; // A4
        gainNode.gain.value = 0.1;
        
        oscillator.connect(gainNode);
        gainNode.connect(tempContext.destination);
        
        oscillator.start();
        oscillator.stop(tempContext.currentTime + 0.1);
        
        console.log('éŸ³é¢‘æµ‹è¯•æˆåŠŸ');
        return true;
      } catch (error) {
        console.error('éŸ³é¢‘æµ‹è¯•å¤±è´¥:', error);
        return false;
      }
    }
    
    // æ’­æ”¾ç®€å•çš„éŸ³æ•ˆ
    function playSound(frequency = 440, duration = 0.5) {
      try {
        if (!audioContext) {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
        } else if (audioContext.state === 'suspended') {
          audioContext.resume();
        }
        
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.type = 'sine';
        oscillator.frequency.value = frequency;
        
        // è¿æ¥èŠ‚ç‚¹
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        // è®¾ç½®éŸ³é‡åŒ…ç»œ
        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
        gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
        gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + duration);
        
        // å¼€å§‹å’Œåœæ­¢æŒ¯è¡å™¨
        oscillator.start();
        oscillator.stop(audioContext.currentTime + duration);
        
        return true;
      } catch (error) {
        console.error('æ’­æ”¾éŸ³æ•ˆå¤±è´¥:', error);
        return false;
      }
    }
    
    // æ’­æ”¾ç”Ÿæ—¥æ­Œ
    function playBirthdaySong() {
      // é¦–å…ˆæ’­æ”¾ä¸€ä¸ªç®€å•çš„éŸ³æ•ˆç¡®è®¤éŸ³é¢‘åŠŸèƒ½æ­£å¸¸
      if (!playSound(880, 0.2)) {
        alert('éŸ³é¢‘åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œï¼Œè¯·ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®åé‡è¯•ã€‚');
        return false;
      }
      
      // åˆ›å»ºæˆ–æ¢å¤éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼ˆç¡®ä¿åœ¨ç”¨æˆ·äº¤äº’ååˆ›å»ºï¼‰
      try {
        // å¦‚æœéŸ³é¢‘Contextå·²å­˜åœ¨ä½†è¢«æš‚åœï¼Œåˆ™æ¢å¤å®ƒ
        if (audioContext) {
          if (audioContext.state === 'suspended') {
            audioContext.resume();
          }
        } else {
          // é¦–æ¬¡åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }
        
        // ç®€åŒ–ç‰ˆç”Ÿæ—¥æ­Œæ—‹å¾‹ - ä½¿ç”¨æ›´ç®€å•çš„éŸ³ç¬¦åºåˆ—
        const notes = [
          {note: 'C4', time: 0}, {note: 'C4', time: 0.5}, {note: 'D4', time: 1}, {note: 'C4', time: 1.5}, {note: 'F4', time: 2}, {note: 'E4', time: 2.5},
          {note: 'C4', time: 3}, {note: 'C4', time: 3.5}, {note: 'D4', time: 4}, {note: 'C4', time: 4.5}, {note: 'G4', time: 5}, {note: 'F4', time: 5.5},
          {note: 'C4', time: 6}, {note: 'C4', time: 6.5}, {note: 'C5', time: 7}, {note: 'A4', time: 7.5}, {note: 'F4', time: 8}, {note: 'E4', time: 8.5}, {note: 'D4', time: 9},
          {note: 'Bb4', time: 9.5}, {note: 'Bb4', time: 10}, {note: 'A4', time: 10.5}, {note: 'F4', time: 11}, {note: 'G4', time: 11.5}, {note: 'F4', time: 12}
        ];
        
        // éŸ³ç¬¦é¢‘ç‡æ˜ å°„
        const noteFrequencies = {
          'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23, 'G4': 392.00, 'A4': 440.00, 'Bb4': 466.16, 'C5': 523.25
        };
        
        // åˆ›å»ºä¸»éŸ³é‡æ§åˆ¶ - æé«˜éŸ³é‡
        const masterGain = audioContext.createGain();
        masterGain.gain.value = 0.5; // é€‚ä¸­éŸ³é‡
        masterGain.connect(audioContext.destination);
        
        // æ’­æ”¾éŸ³ç¬¦
        notes.forEach((noteObj) => {
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.type = 'sine';
          oscillator.frequency.value = noteFrequencies[noteObj.note];
          
          // è¿æ¥èŠ‚ç‚¹
          oscillator.connect(gainNode);
          gainNode.connect(masterGain);
          
          // è®¾ç½®éŸ³é‡åŒ…ç»œ - ç®€åŒ–åŒ…åŒ…ç»œï¼Œä½¿éŸ³ç¬¦æ›´æ¸…æ™°
          const now = audioContext.currentTime + noteObj.time * 0.4; // è°ƒæ•´èŠ‚å¥
          gainNode.gain.setValueAtTime(0, now);
          gainNode.gain.linearRampToValueAtTime(1, now + 0.05);
          gainNode.gain.linearRampToValueAtTime(0.9, now + 0.25);
          gainNode.gain.linearRampToValueAtTime(0, now + 0.35);
          
          // å¼€å§‹å’Œåœæ­¢æŒ¯è¡å™¨
          oscillator.start(now);
          oscillator.stop(now + 0.35);
        });
        
        // æ˜¾ç¤ºåŠ¨ç”»æ•ˆæœ
        const pig = document.getElementById('pig');
        pig.classList.add('animate-sparkle');
        
        // 8ç§’åç§»é™¤åŠ¨ç”»ç±»
        setTimeout(() => {
          pig.classList.remove('animate-sparkle');
        }, 8000);
        
        // æ’­æ”¾å®Œæ¯•åæ˜¾ç¤ºåº†ç¥æ•ˆæœ
        setTimeout(() => {
          celebrate();
        }, 8000);
        
        return true;
      } catch (error) {
        console.error('æ’­æ”¾ç”Ÿæ—¥æ­Œå¤±è´¥:', error);
        // æ˜¾ç¤ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
        if (error.name === 'NotAllowedError') {
          alert('éŸ³é¢‘æ’­æ”¾åŠŸèƒ½å¤±è´¥: æµè§ˆå™¨é˜»æ­¢äº†éŸ³é¢‘æ’­æ”¾ã€‚è¯·å…ˆç‚¹å‡»é¡µé¢ä»»æ„å¤„æ¿€æ´»éŸ³é¢‘ï¼Œç„¶åå†å°è¯•æ’­æ”¾ç”Ÿæ—¥æ­Œã€‚');
        } else if (error.name === 'InvalidStateError') {
          alert('éŸ³é¢‘æ’­æ”¾åŠŸèƒ½å¤±è´¥: éŸ³é¢‘ä¸Šä¸‹æ–‡å·²è¢«æš‚åœã€‚è¯·å…ˆç‚¹å‡»ä¸€æ¬¡æ’­æ”¾ç”Ÿæ—¥æ­ŒæŒ‰é’®é‡è¯•ã€‚');
        } else {
          alert(`æ’­æ”¾ç”Ÿæ—¥æ­Œå¤±è´¥: ${error.message}ã€‚è¯·å°è¯•ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹åå†è¯•ã€‚`);
        }
        return false;
      }
    }
    
    // æ˜¾ç¤ºç¥ç¦è¯­å¼¹çª—ï¼ˆæ˜¾ç¤ºå›¾ç‰‡ï¼‰
    function showWishModal() {
      // åˆ›å»ºå¼¹çª—å®¹å™¨
      const modalContainer = document.createElement('div');
      modalContainer.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-70';
      
      // åˆ›å»ºå¼¹çª—å†…å®¹
      const modalContent = document.createElement('div');
      modalContent.className = 'bg-white rounded-lg p-4 max-w-lg w-full mx-4 animate-scale-in';
      
      // åˆ›å»ºå›¾ç‰‡å®¹å™¨
      const imageContainer = document.createElement('div');
      imageContainer.className = 'relative w-full';
      
      // åˆ›å»ºç¥ç¦å›¾ç‰‡
      const wishImage = document.createElement('img');
      wishImage.src = 'https://p26-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/40ffe8f6da3f469eaccdd548c5e4188d.png~tplv-a9rns2rl98-24:720:720.png?rcl=20251019145136D1D0078C51223D48D54C&rk3s=8e244e95&rrcfp=8a172a1a&x-expires=1761461496&x-signature=lB9oBnJSCs5FnT4QeLaFnP%2Bz6wQ%3D';
      wishImage.alt = 'ç”Ÿæ—¥ç¥ç¦å›¾ç‰‡';
      wishImage.className = 'w-full rounded-lg';
      
      // åˆ›å»ºå…³é—­æŒ‰é’®
      const closeBtn = document.createElement('button');
      closeBtn.className = 'absolute -top-4 -right-4 bg-red-500 hover:bg-red-600 text-white font-bold w-10 h-10 rounded-full shadow-lg flex items-center justify-center transition-all duration-300';
      closeBtn.innerHTML = '<i class="fa fa-times"></i>';
      closeBtn.addEventListener('click', () => {
        modalContainer.remove();
      });
      
      // ç»„è£…å¼¹çª—
      imageContainer.appendChild(wishImage);
      imageContainer.appendChild(closeBtn);
      modalContent.appendChild(imageContainer);
      modalContainer.appendChild(modalContent);
      document.body.appendChild(modalContainer);
      
      // æ’­æ”¾æç¤ºéŸ³æ•ˆ
      playSound(880, 0.3);
      
      // å°çŒªåŠ¨ç”»æ•ˆæœ
      const pig = document.getElementById('pig');
      pig.classList.add('animate-sparkle');
      
      // 2ç§’åç§»é™¤åŠ¨ç”»ç±»
      setTimeout(() => {
        pig.classList.remove('animate-sparkle');
      }, 2000);
    }
    
    // æ’­æ”¾å®Œæ•´ç”Ÿæ—¥éŸ³ä¹
    function playFullBirthdaySong() {
      try {
        // é¦–å…ˆæ’­æ”¾ä¸€ä¸ªç®€å•çš„éŸ³æ•ˆç¡®è®¤éŸ³é¢‘åŠŸèƒ½æ­£å¸¸
        if (!playSound(880, 0.2)) {
          console.log('éŸ³é¢‘åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œ');
          return false;
        }
        
        // åˆ›å»ºæˆ–æ¢å¤éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼ˆç¡®ä¿åœ¨ç”¨æˆ·äº¤äº’ååˆ›å»ºï¼‰
        if (!audioContext) {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
        } else if (audioContext.state === 'suspended') {
          audioContext.resume();
        }
        
        // å®Œæ•´ç”Ÿæ—¥æ­Œæ—‹å¾‹
        const notes = [
          // ç¬¬ä¸€æ®µ
          {note: 'C4', time: 0}, {note: 'C4', time: 0.5}, {note: 'D4', time: 1}, {note: 'C4', time: 1.5}, {note: 'F4', time: 2}, {note: 'E4', time: 2.5},
          {note: 'C4', time: 3}, {note: 'C4', time: 3.5}, {note: 'D4', time: 4}, {note: 'C4', time: 4.5}, {note: 'G4', time: 5}, {note: 'F4', time: 5.5},
          {note: 'C4', time: 6}, {note: 'C4', time: 6.5}, {note: 'C5', time: 7}, {note: 'A4', time: 7.5}, {note: 'F4', time: 8}, {note: 'E4', time: 8.5}, {note: 'D4', time: 9},
          {note: 'Bb4', time: 9.5}, {note: 'Bb4', time: 10}, {note: 'A4', time: 10.5}, {note: 'F4', time: 11}, {note: 'G4', time: 11.5}, {note: 'F4', time: 12},
          
          // ç¬¬äºŒæ®µï¼ˆé‡å¤ï¼‰
          {note: 'C4', time: 12.5}, {note: 'C4', time: 13}, {note: 'D4', time: 13.5}, {note: 'C4', time: 14}, {note: 'F4', time: 14.5}, {note: 'E4', time: 15},
          {note: 'C4', time: 15.5}, {note: 'C4', time: 16}, {note: 'D4', time: 16.5}, {note: 'C4', time: 17}, {note: 'G4', time: 17.5}, {note: 'F4', time: 18},
          {note: 'C4', time: 18.5}, {note: 'C4', time: 19}, {note: 'C5', time: 19.5}, {note: 'A4', time: 20}, {note: 'F4', time: 20.5}, {note: 'E4', time: 21}, {note: 'D4', time: 21.5},
          {note: 'G4', time: 22}, {note: 'G4', time: 22.5}, {note: 'F4', time: 23}, {note: 'E4', time: 23.5}, {note: 'D4', time: 24}, {note: 'C4', time: 24.5}
        ];
        
        // éŸ³ç¬¦é¢‘ç‡æ˜ å°„
        const noteFrequencies = {
          'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23, 'G4': 392.00, 'A4': 440.00, 'Bb4': 466.16, 'C5': 523.25
        };
        
        // åˆ›å»ºä¸»éŸ³é‡æ§åˆ¶
        const masterGain = audioContext.createGain();
        masterGain.gain.value = 0.5; // é€‚ä¸­éŸ³é‡
        masterGain.connect(audioContext.destination);
        
        // æ’­æ”¾éŸ³ç¬¦
        notes.forEach((noteObj) => {
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.type = 'sine';
          oscillator.frequency.value = noteFrequencies[noteObj.note];
          
          // è¿æ¥èŠ‚ç‚¹
          oscillator.connect(gainNode);
          gainNode.connect(masterGain);
          
          // è®¾ç½®éŸ³é‡åŒ…ç»œ
          const now = audioContext.currentTime + noteObj.time * 0.4; // è°ƒæ•´èŠ‚å¥
          gainNode.gain.setValueAtTime(0, now);
          gainNode.gain.linearRampToValueAtTime(1, now + 0.05);
          gainNode.gain.linearRampToValueAtTime(0.9, now + 0.25);
          gainNode.gain.linearRampToValueAtTime(0, now + 0.35);
          
          // å¼€å§‹å’Œåœæ­¢æŒ¯è¡å™¨
          oscillator.start(now);
          oscillator.stop(now + 0.35);
        });
        
        return true;
      } catch (error) {
        console.error('æ’­æ”¾ç”Ÿæ—¥éŸ³ä¹å¤±è´¥:', error);
        return false;
      }
    }
    
    // åº†ç¥ä¸€ä¸‹ï¼ˆå®Œæ•´ç‰ˆï¼‰
    function celebrate() {
      console.log('åº†ç¥ä¸€ä¸‹åŠŸèƒ½è¢«è°ƒç”¨');
      
      // åˆ›å»ºå½©è‰²çº¸å±‘
      createConfetti();
      
      // åˆ›å»ºè¾¹ç¼˜å°çƒŸèŠ±
      createEdgeFireworks();
      
      // æ’­æ”¾å®Œæ•´ç”Ÿæ—¥éŸ³ä¹
      playFullBirthdaySong();
      
      // å°çŒªåŠ¨ç”»æ•ˆæœ
      const pig = document.getElementById('pig');
      if (pig) {
        pig.classList.add('animate-sparkle');
        setTimeout(() => {
          pig.classList.remove('animate-sparkle');
        }, 10000); // å»¶é•¿åŠ¨ç”»æ—¶é—´ï¼Œä¸éŸ³ä¹åŒæ­¥
      }
      
      // æ·»åŠ å±å¹•é—ªçƒæ•ˆæœ
      const overlay = document.createElement('div');
      overlay.className = 'fixed inset-0 bg-white opacity-0 z-60 pointer-events-none';
      document.body.appendChild(overlay);
      
      setTimeout(() => {
        overlay.style.transition = 'opacity 0.1s';
        overlay.style.opacity = '0.3';
        setTimeout(() => {
          overlay.style.opacity = '0';
          setTimeout(() => {
            overlay.remove();
          }, 100);
        }, 100);
      }, 10);
    }
    
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–åŠ¨ç”»å’Œäº‹ä»¶ç›‘å¬');
      
      createScanlines();
      initAnimation();
      
      // æ·»åŠ æŒ‰é’®äº‹ä»¶ç›‘å¬
      const wishBtn = document.getElementById('wish-btn');
      const confettiBtn = document.getElementById('confetti-btn');
      
      // ä¸ºäº†ç¡®ä¿æŒ‰é’®å¯ç‚¹å‡»ï¼Œæ·»åŠ ä¸€ä¸ªç®€å•çš„ç‚¹å‡»æ•ˆæœ
      const addButtonClickEffect = (button) => {
        if (button) {
          button.style.cursor = 'pointer';
          button.addEventListener('mousedown', () => {
            button.style.transform = 'scale(0.95)';
          });
          button.addEventListener('mouseup', () => {
            button.style.transform = 'scale(1)';
          });
          button.addEventListener('mouseleave', () => {
            button.style.transform = 'scale(1)';
          });
          button.addEventListener('touchstart', () => {
            button.style.transform = 'scale(0.95)';
          });
          button.addEventListener('touchend', () => {
            button.style.transform = 'scale(1)';
          });
        }
      };
      
      // æ·»åŠ æŒ‰é’®ç‚¹å‡»æ•ˆæœ
      addButtonClickEffect(wishBtn);
      addButtonClickEffect(confettiBtn);
      
      if (wishBtn) {
        wishBtn.addEventListener('click', () => {
          console.log('ç‚¹å‡»æœ‰ç¥ç¦æŒ‰é’®è¢«ç‚¹å‡»');
          // é¦–æ¬¡ç‚¹å‡»æ—¶è¿›è¡ŒéŸ³é¢‘æµ‹è¯•
          testAudioOnFirstInteraction();
          try {
            showWishModal();
          } catch (error) {
            console.error('æ˜¾ç¤ºç¥ç¦çª—å£å¤±è´¥:', error);
            // é™çº§å¤„ç† - æ˜¾ç¤ºç®€å•çš„alert
            alert('æ„¿ä½ æ¯ä¸€å¤©éƒ½åƒä»Šå¤©ä¸€æ ·å¼€å¿ƒå¿«ä¹ï¼');
          }
        });
      } else {
        console.error('æœªæ‰¾åˆ°wish-btnå…ƒç´ ');
        // æ·»åŠ é™çº§å¤„ç† - ç›´æ¥åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºæç¤º
        setTimeout(() => {
          const message = document.createElement('div');
          message.className = 'fixed bottom-4 left-0 right-0 text-center text-red-500';
          message.textContent = 'æŒ‰é’®åŠ è½½å¤±è´¥ï¼Œè¯·ç‚¹å‡»å°çŒªå›¾ç‰‡è·å–ç¥ç¦';
          document.body.appendChild(message);
        }, 3000);
      }
      
      // æ”¹è¿›åº†ç¥åº†ç¥æŒ‰é’®äº‹ä»¶ç»‘å®š
      const bindCelebrateButton = () => {
        const confettiBtn = document.getElementById('confetti-btn');
        
        if (confettiBtn) {
          console.log('æ‰¾åˆ°åº†ç¥æŒ‰é’®ï¼Œç»‘å®šäº‹ä»¶');
          
          // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
          confettiBtn.replaceWith(confettiBtn.cloneNode(true));
          const newConfettiBtn = document.getElementById('confetti-btn');
          
          // é‡æ–°ç»‘å®šäº‹ä»¶
          newConfettiBtn.addEventListener('click', function(e) {
            console.log('åº†ç¥æŒ‰é’®è¢«ç‚¹å‡»');
            e.stopPropagation();
            celebrate();
          });
          
          // æ·»åŠ è§¦æ‘¸äº‹ä»¶æ”¯æŒ
          newConfettiBtn.addEventListener('touchstart', function(e) {
            console.log('åº†ç¥æŒ‰é’®è¢«è§¦æ‘¸');
            e.stopPropagation();
            celebrate();
          });
          
          // æ·»åŠ ç‚¹å‡»è§†è§‰åé¦ˆ
          addButtonClickEffect(newConfettiBtn);
        } else {
          console.error('æœªæ‰¾åˆ°confetti-btnå…ƒç´ ');
          
          // åˆ›å»ºå¤‡ç”¨æŒ‰é’®
          setTimeout(() => {
            const fallbackBtn = document.createElement('button');
            fallbackBtn.textContent = 'åº†ç¥ä¸€ä¸‹ä¸‹ (å¤‡ç”¨)';
            fallbackBtn.className = 'mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-10 rounded-full shadow-lg transition-all duration-300 z-20 w-full';
            fallbackBtn.addEventListener('click', celebrate);
            document.getElementById('interaction').appendChild(fallbackBtn);
          }, 1000);
        }
      };
      
      // ç»‘å®šåº†ç¥æŒ‰é’®äº‹ä»¶
      bindCelebrateButton();
      
      // æ·»åŠ é”®ç›˜äº¤äº’
      document.addEventListener('keydown', (e) => {
        console.log('é”®ç›˜æŒ‰é”®è¢«æŒ‰ä¸‹:', e.key);
        if (e.key === ' ' || e.key === 'Enter') {
          // é¦–æ¬¡æŒ‰ä¸‹æ—¶è¿›è¡ŒéŸ³é¢‘æµ‹è¯•
          testAudioOnFirstInteraction();
          try {
            showWishModal();
          } catch (error) {
            console.error('é”®ç›˜è§¦å‘å‘çª—å£å¤±è´¥:', error);
            alert('æ„¿ä½ æ¯ä¸€å¤©éƒ½åƒä»Šå¤©ä¸€æ ·å¼€å¿ƒå¿«ä¹ï¼');
          }
        } else if (e.key === 'f') {
          try {
            celebrate();
          } catch (error) {
            console.error('é”®ç›˜åº†ç¥æ•ˆæœæ‰§è¡Œå¤±è´¥:', error);
            createConfetti();
          }
        }
      });
      
      // æ·»åŠ è§¦æ‘¸äº¤äº’ - ç‚¹å‡»å°çŒªå›¾ç‰‡ä¼šä¸Šä¸‹è·³ä¸€ä¸‹
      const pigContainer = document.getElementById('pig-container');
      const pigImage = document.getElementById('pig');
      if (pigContainer && pigImage) {
        pigContainer.style.cursor = 'pointer';
        pigContainer.addEventListener('click', () => {
          console.log('å°çŒªå›¾ç‰‡è¢«ç‚¹å‡»');
          // ç§»é™¤floatåŠ¨ç”»
          pigImage.classList.remove('animate-float');
          // æ·»åŠ å¼¹è·³åŠ¨ç”»
          pigImage.classList.add('animate-bounce');
          // æ’­æ”¾å¼¹è·³éŸ³æ•ˆ
          playSound(440, 0.2);
          // 0.5ç§’åæ¢å¤floatåŠ¨ç”»
          setTimeout(() => {
            pigImage.classList.remove('animate-bounce');
            pigImage.classList.add('animate-float');
          }, 500);
        });
      }
      
      // æ·»åŠ é¡µé¢ç‚¹å‡»äº‹ä»¶ï¼Œç”¨äºæ¿€æ´»éŸ³é¢‘
      document.addEventListener('click', function initAudio() {
        console.log('é¡µé¢è¢«ç‚¹å‡»ï¼Œå°è¯•æ¿€æ´»éŸ³é¢‘');
        try {
          testAudioOnFirstInteraction();
        } catch (error) {
          console.error('éŸ³é¢‘åˆå§‹åŒ–å¤±è´¥:', error);
        }
        // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼Œé¿å…é‡å¤è°ƒç”¨
        document.removeEventListener('click', initAudio);
      }, { once: true });
      
      // æ·»åŠ ä¸€ä¸ªç®€å•çš„æµ‹è¯•æŒ‰é’®ï¼Œç”¨äºè°ƒè¯•
      const testButton = document.createElement('button');
      testButton.textContent = 'æµ‹è¯•';
      testButton.className = 'fixed bottom-2 left-2 bg-gray-200 text-black px-2 py-1 rounded text-xs z-50';
      testButton.addEventListener('click', () => {
        alert('é¡µé¢äº¤äº’æ­£å¸¸ï¼');
        console.log('æµ‹è¯•æŒ‰é’®è¢«ç‚¹å‡»');
      });
      document.body.appendChild(testButton);
    });
  </script>
</body>
</html>
